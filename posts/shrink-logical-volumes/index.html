<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta property="og:title" content="Shrink logic volumes"><meta property="og:description" content="Use LVM2 to shrink volumes on the fly."><meta property="og:type" content="article"><meta property="og:url" content="https://cgerull.github.io/techinfo/posts/shrink-logical-volumes/"><meta property="article:published_time" content="2014-04-08T00:00:00+00:00"><meta property="article:modified_time" content="2014-04-08T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Shrink logic volumes"><meta name=twitter:description content="Use LVM2 to shrink volumes on the fly."><meta name=generator content="Hugo 0.101.0"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Shrink logic volumes","url":"https://cgerull.github.io/techinfo/posts/shrink-logical-volumes/","wordCount":"210","datePublished":"2014-04-08T00:00:00+00:00","dateModified":"2014-04-08T00:00:00+00:00","author":{"@type":"Person","name":null},"keywords":"Linux, File System, Install, Logical Volumes","description":"Use LVM2 to shrink volumes on the fly."}</script><link rel=canonical href=https://cgerull.github.io/techinfo/posts/shrink-logical-volumes/><title>Shrink logic volumes | techinfo.gerull.nl</title><link href=https://cgerull.github.io/techinfo/css/style.beb8012edc08ba10be012f079d618dc243812267efe62e11f22fe49618f976a4.css rel=stylesheet integrity="sha256-vrgBLtwIuhC+AS8HnWGNwkOBImfv5i4R8i/klhj5dqQ=" crossorigin=anonymous><script defer src=https://cgerull.github.io/techinfo/js/fontawesome.min.f5072c55a0721857184db93a50561d7dc13975b4de2e19db7f81eb5f3fa57270.js integrity="sha256-9QcsVaByGFcYTbk6UFYdfcE5dbTeLhnbf4HrXz+lcnA=" crossorigin=anonymous></script></head><body><div class=blog-masthead><div class=container><nav class="nav blog-nav"><a class=nav-link href=https://cgerull.github.io/techinfo>Home</a></nav></div></div><header class=blog-header><div class=container><h1 class=blog-title dir=auto><a href=https://cgerull.github.io/techinfo rel=home>techinfo.gerull.nl</a></h1></div></header><div class=container><div class=row><div class="col-sm-8 blog-main"><article class=blog-post><header><h2 class=blog-post-title dir=auto><a href=https://cgerull.github.io/techinfo/posts/shrink-logical-volumes/>Shrink logic volumes</a></h2><p class=blog-post-meta><time datetime=2014-04-08T00:00:00Z>Tue Apr 8, 2014</time>
in
<span class="fas fa-folder" aria-hidden=true></span>&nbsp;<a href=/categories/linux/ rel="category tag">Linux</a>
<span class="fas fa-tag" aria-hidden=true></span>&nbsp;<a href=/tags/file-system/ rel=tag>File System</a>, <a href=/tags/install/ rel=tag>Install</a>, <a href=/tags/linux/ rel=tag>Linux</a>, <a href=/tags/logical-volumes/ rel=tag>Logical Volumes</a></p></header><p>In this post I will point out the steps to shrink logic volumes.</p><p>The order of shrinking is just the reverse of expanding:</p><ul><li>un-mount the file system</li><li>check file system integrity</li><li>shrink file system</li><li>shrink logic volume.</li></ul><blockquote><p><strong>Before you start make sure you have recent backup of the disk.</strong></p></blockquote><h2 id=the-steps-in-detail>The steps in detail</h2><p>1. First un-mount the file system to make sure no one has access anymore. For some file systems you must switch to single user mode for this. Then check the file system integrity.</p><ul><li>if /yyy is the mount point <code>sudo umount /yyy</code></li><li>As this is a logical volume, vg-xxx is the volume group and yyy is the symbolic name of the lv. <code>sudo e2fsck -f /dev/mapper/vg-xxx/yyy</code></li></ul><p>2. Shrink the file system to some point
<code>sudo resize2fs /dev/mapper/vg-xxx/yyy 2000M</code>
Here it goes down to 2G, but <strong>above</strong> the physical size of existing files. This command works for both ext2 and ext3.</p><p>3. Shrink the logic volume
<code>sudo lvresize -L -1G /dev/mapper/vg-xxx/yyy</code>
Here the logic volume is shrunk by 1G. Don&rsquo;t shrink beyond your file system size, the consequences are disastrous. Do the math. <em>And take it very serious!</em></p><p>4. Expand the file system to fit the shrunk logic volume
<code>sudo resize2fs -p /dev/mapper/vg-xxx/yyy</code></p><p>5. Remount the file system.</p><hr><footer><section><h4>Share</h4><nav class="nav sharing-icons"><a class=nav-item href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fcgerull.github.io%2ftechinfo%2fposts%2fshrink-logical-volumes%2f" title="Share on Facebook"><span class="fab fa-facebook-f fa-2x" aria-hidden=true></span></a>
<a class=nav-item href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fcgerull.github.io%2ftechinfo%2fposts%2fshrink-logical-volumes%2f" title="Share on LinkedIn"><span class="fab fa-linkedin-in fa-2x" aria-hidden=true></span></a>
<a class=nav-item href="https://twitter.com/intent/tweet?url=https%3a%2f%2fcgerull.github.io%2ftechinfo%2fposts%2fshrink-logical-volumes%2f&text=Shrink%20logic%20volumes" title="Tweet this"><span class="fab fa-twitter fa-2x"></span></a></nav></section></footer></article></div><aside class="col-sm-3 ml-auto blog-sidebar"></aside></div></div><footer class=blog-footer><p dir=auto>Blog template created by <a href=https://twitter.com/mdo>@mdo</a>, ported to Hugo by <a href=https://twitter.com/mralanorth>@mralanorth</a>.</p><p><a href=#>Back to top</a></p></footer></body></html>